<script>
    // URL da sua planilha via OpenSheet
    const url = "https://opensheet.elk.sh/1zEm8yPwHF7sJC0JM5E9wCTfGtpXEH10Rado4LamW5_M/Página1";

    async function carregarLinks() {
      try {
        const response = await fetch(url);
        const dados = await response.json();
        const lista = document.getElementById("lista");
        
        lista.innerHTML = ""; 

        dados.forEach(item => {
          const btn = document.createElement("a");
          btn.className = "botao";
          
          // IMPORTANTE: Aqui usamos os nomes EXATOS das suas colunas na planilha
          // Se na planilha está "Link", aqui tem que ser item["Link"]
          const linkDestino = item["Link"] || item["link"];
          const nomeBotao = item["Nome do Botão"] || item["nome"];
          const statusAtivo = item["Ativo"] || item["ativo"];

          btn.href = linkDestino;
          btn.textContent = nomeBotao;
          btn.target = "_blank";

          // Verifica se está ativo
          if (!statusAtivo || statusAtivo.toLowerCase() !== "sim") {
            btn.classList.add("inativo");
            btn.textContent += " (Indisponível)";
          }

          // Só adiciona se o link não for undefined
          if (linkDestino) {
            lista.appendChild(btn);
          }
        });

      } catch (erro) {
        document.getElementById("lista").innerHTML = "Erro ao carregar dados.";
      }
    }

    carregarLinks();
  </script>
